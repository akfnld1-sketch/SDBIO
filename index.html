<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SD BIOSENSOR ì¶œê·¼ë¶€</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="SD BIOSENSOR">
<meta name="theme-color" content="#0d1117">
<link rel="apple-touch-icon" href="icon.png">
<link rel="manifest" href="manifest.json">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&family=Bebas+Neue&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0d1117;
    --surface: #161b22;
    --surface2: #21262d;
    --border: #30363d;
    --accent: #f0a500;
    --accent2: #ff6b35;
    --text: #e6edf3;
    --text2: #8b949e;
    --green: #3fb950;
    --red: #f85149;
    --blue: #58a6ff;
    --purple: #bc8cff;
    --yellow: #e3b341;
  }
  * { margin:0; padding:0; box-sizing:border-box; }
  body {
    font-family: 'Noto Sans KR', sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* HEADER */
  .header {
    background: var(--surface);
    border-bottom: 1px solid var(--border);
    padding: 16px 24px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    position: sticky;
    top: 0;
    z-index: 100;
    backdrop-filter: blur(8px);
  }
  .header-title {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 28px;
    letter-spacing: 3px;
    color: var(--accent);
  }
  .header-sub {
    font-size: 11px;
    color: var(--text2);
    letter-spacing: 1px;
  }
  .nav-btn {
    background: var(--accent);
    color: #000;
    border: none;
    padding: 10px 20px;
    border-radius: 8px;
    font-family: 'Noto Sans KR', sans-serif;
    font-weight: 700;
    font-size: 14px;
    cursor: pointer;
    transition: all 0.2s;
    letter-spacing: 0.5px;
  }
  .nav-btn:hover { background: #ffc235; transform: translateY(-1px); }

  /* PAGES */
  .page { display: none; animation: fadeIn 0.3s ease; }
  .page.active { display: block; }
  @keyframes fadeIn { from { opacity:0; transform:translateY(8px); } to { opacity:1; transform:translateY(0); } }

  /* CALENDAR PAGE */
  .calendar-container { max-width: 900px; margin: 0 auto; padding: 24px 16px; }
  .month-nav {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 24px;
    margin-bottom: 24px;
  }
  .month-nav button {
    background: var(--surface2);
    border: 1px solid var(--border);
    color: var(--text);
    width: 40px; height: 40px;
    border-radius: 8px;
    font-size: 18px;
    cursor: pointer;
    transition: all 0.2s;
  }
  .month-nav button:hover { border-color: var(--accent); color: var(--accent); }
  .month-title {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 32px;
    letter-spacing: 2px;
    color: var(--text);
  }

  .calendar {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 16px;
    overflow: hidden;
  }
  .cal-header {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    background: var(--surface2);
    border-bottom: 1px solid var(--border);
  }
  .cal-header div {
    text-align: center;
    padding: 12px;
    font-size: 12px;
    font-weight: 700;
    letter-spacing: 1px;
    color: var(--text2);
  }
  .cal-header div:first-child { color: var(--red); }
  .cal-header div:last-child { color: var(--blue); }

  .cal-grid {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
  }
  .cal-day {
    min-height: 80px;
    border-right: 1px solid var(--border);
    border-bottom: 1px solid var(--border);
    padding: 8px;
    cursor: pointer;
    transition: background 0.15s;
    position: relative;
  }
  .cal-day:nth-child(7n) { border-right: none; }
  .cal-day:hover { background: var(--surface2); }
  .cal-day.empty { cursor: default; background: transparent; }
  .cal-day.empty:hover { background: transparent; }
  .cal-day.today .day-num {
    background: var(--accent);
    color: #000;
    border-radius: 50%;
    width: 26px; height: 26px;
    display: flex; align-items: center; justify-content: center;
    font-weight: 700;
  }
  .day-num {
    font-size: 13px;
    font-weight: 500;
    margin-bottom: 4px;
    width: 26px; height: 26px;
    display: flex; align-items: center; justify-content: center;
  }
  .cal-day:nth-child(7n+1) .day-num { color: var(--red); }
  .cal-day:nth-child(7n) .day-num { color: var(--blue); }

  .day-badge {
    font-size: 10px;
    font-weight: 700;
    padding: 2px 6px;
    border-radius: 4px;
    display: inline-block;
    margin-bottom: 2px;
  }
  .badge-ì¶œê·¼ { background: #1a3a1a; color: var(--green); }
  .badge-ì—°ì°¨ { background: #2a1a3a; color: var(--purple); }
  .badge-ë°˜ì°¨ { background: #1a2a3a; color: var(--blue); }
  .badge-ì¡°í‡´ { background: #3a2a1a; color: var(--yellow); }
  .badge-ê²°ê·¼ { background: #3a1a1a; color: var(--red); }
  .badge-ê³µíœ´ì¼ { background: #3a1a1a; color: #ff9999; }
  .day-time {
    font-size: 9px;
    color: var(--text2);
    line-height: 1.4;
  }
  .day-overtime {
    font-size: 9px;
    color: var(--accent);
  }

  /* MODAL */
  .modal-overlay {
    position: fixed; inset: 0;
    background: rgba(0,0,0,0.7);
    backdrop-filter: blur(4px);
    z-index: 200;
    display: none;
    align-items: center;
    justify-content: center;
    padding: 16px;
  }
  .modal-overlay.open { display: flex; }
  .modal {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 24px;
    width: 100%;
    max-width: 420px;
    animation: slideUp 0.25s ease;
  }
  @keyframes slideUp { from { transform: translateY(20px); opacity:0; } to { transform: translateY(0); opacity:1; } }
  .modal-title {
    font-size: 18px;
    font-weight: 700;
    margin-bottom: 20px;
    color: var(--accent);
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .modal-date {
    font-size: 13px;
    color: var(--text2);
    margin-bottom: 20px;
  }

  .status-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 8px;
    margin-bottom: 20px;
  }
  .status-btn {
    background: var(--surface2);
    border: 2px solid var(--border);
    color: var(--text);
    padding: 10px;
    border-radius: 10px;
    font-family: 'Noto Sans KR', sans-serif;
    font-size: 13px;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s;
    text-align: center;
  }
  .status-btn:hover { border-color: var(--accent); }
  .status-btn.selected { border-color: var(--accent); background: rgba(240,165,0,0.15); color: var(--accent); }
  .status-btn[data-v="ì¶œê·¼"].selected { border-color: var(--green); background: rgba(63,185,80,0.15); color: var(--green); }
  .status-btn[data-v="ì—°ì°¨"].selected { border-color: var(--purple); background: rgba(188,140,255,0.15); color: var(--purple); }
  .status-btn[data-v="ë°˜ì°¨"].selected { border-color: var(--blue); background: rgba(88,166,255,0.15); color: var(--blue); }
  .status-btn[data-v="ì¡°í‡´"].selected { border-color: var(--yellow); background: rgba(227,179,65,0.15); color: var(--yellow); }
  .status-btn[data-v="ê²°ê·¼"].selected { border-color: var(--red); background: rgba(248,81,73,0.15); color: var(--red); }
  .status-btn[data-v="ê³µíœ´ì¼"].selected { border-color: #ff9999; background: rgba(255,153,153,0.15); color: #ff9999; }

  .time-section { margin-bottom: 16px; }
  .time-label {
    font-size: 12px;
    color: var(--text2);
    margin-bottom: 8px;
    font-weight: 500;
    letter-spacing: 0.5px;
  }
  .time-select {
    background: var(--surface2);
    border: 1px solid var(--border);
    color: var(--text);
    padding: 10px 14px;
    border-radius: 8px;
    font-family: 'Noto Sans KR', sans-serif;
    font-size: 14px;
    width: 100%;
    cursor: pointer;
    outline: none;
    transition: border-color 0.2s;
  }
  .time-select:focus { border-color: var(--accent); }
  .time-select option { background: var(--surface2); }

  .overtime-info {
    background: rgba(240,165,0,0.1);
    border: 1px solid rgba(240,165,0,0.3);
    border-radius: 8px;
    padding: 10px 14px;
    font-size: 12px;
    color: var(--accent);
    margin-bottom: 16px;
  }

  .modal-actions {
    display: flex;
    gap: 10px;
  }
  .btn-save {
    flex: 1;
    background: var(--accent);
    color: #000;
    border: none;
    padding: 12px;
    border-radius: 8px;
    font-family: 'Noto Sans KR', sans-serif;
    font-weight: 700;
    font-size: 14px;
    cursor: pointer;
    transition: all 0.2s;
  }
  .btn-save:hover { background: #ffc235; }
  .btn-cancel {
    background: var(--surface2);
    color: var(--text2);
    border: 1px solid var(--border);
    padding: 12px 20px;
    border-radius: 8px;
    font-family: 'Noto Sans KR', sans-serif;
    font-size: 14px;
    cursor: pointer;
    transition: all 0.2s;
  }
  .btn-cancel:hover { border-color: var(--text2); color: var(--text); }
  .btn-delete {
    background: rgba(248,81,73,0.15);
    color: var(--red);
    border: 1px solid rgba(248,81,73,0.3);
    padding: 12px 16px;
    border-radius: 8px;
    font-family: 'Noto Sans KR', sans-serif;
    font-size: 13px;
    cursor: pointer;
    transition: all 0.2s;
  }
  .btn-delete:hover { background: rgba(248,81,73,0.25); }

  /* SUMMARY STRIP */
  .summary-strip {
    display: flex;
    gap: 12px;
    margin-bottom: 24px;
    flex-wrap: wrap;
  }
  .summary-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 12px 16px;
    flex: 1;
    min-width: 100px;
    text-align: center;
  }
  .summary-card .s-num {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 28px;
    line-height: 1;
    margin-bottom: 4px;
  }
  .summary-card .s-label { font-size: 11px; color: var(--text2); font-weight: 500; }

  /* PAYROLL PAGE */
  .payroll-container { max-width: 700px; margin: 0 auto; padding: 24px 16px; }
  .payroll-title {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 36px;
    letter-spacing: 3px;
    color: var(--accent);
    margin-bottom: 8px;
  }
  .payroll-sub { font-size: 13px; color: var(--text2); margin-bottom: 28px; }

  .pay-section {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 20px;
    margin-bottom: 16px;
  }
  .pay-section-title {
    font-size: 12px;
    font-weight: 700;
    color: var(--text2);
    letter-spacing: 1.5px;
    text-transform: uppercase;
    margin-bottom: 16px;
    padding-bottom: 10px;
    border-bottom: 1px solid var(--border);
  }

  .pay-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 0;
    border-bottom: 1px solid rgba(48,54,61,0.5);
  }
  .pay-row:last-child { border-bottom: none; }
  .pay-row-label { font-size: 13px; color: var(--text2); }
  .pay-row-value { font-size: 14px; font-weight: 600; color: var(--text); }
  .pay-row-value.highlight { color: var(--accent); }
  .pay-row-value.deduct { color: var(--red); }
  .pay-row-value.add { color: var(--green); }

  .pay-input-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 0;
    gap: 12px;
    border-bottom: 1px solid rgba(48,54,61,0.5);
  }
  .pay-input-row:last-child { border-bottom: none; }
  .pay-input-label { font-size: 13px; color: var(--text2); flex-shrink: 0; }
  .pay-input-controls { display: flex; align-items: center; gap: 8px; }
  .pay-toggle {
    background: var(--surface2);
    border: 1px solid var(--border);
    color: var(--text2);
    padding: 6px 14px;
    border-radius: 6px;
    font-family: 'Noto Sans KR', sans-serif;
    font-size: 12px;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s;
  }
  .pay-toggle.on { background: rgba(63,185,80,0.15); border-color: var(--green); color: var(--green); }

  .pay-number-input {
    background: var(--surface2);
    border: 1px solid var(--border);
    color: var(--text);
    padding: 6px 10px;
    border-radius: 6px;
    font-family: 'Noto Sans KR', sans-serif;
    font-size: 13px;
    width: 80px;
    text-align: right;
    outline: none;
  }
  .pay-number-input:focus { border-color: var(--accent); }
  .pay-unit { font-size: 12px; color: var(--text2); }

  .total-box {
    background: linear-gradient(135deg, rgba(240,165,0,0.15), rgba(255,107,53,0.1));
    border: 1px solid rgba(240,165,0,0.4);
    border-radius: 14px;
    padding: 24px;
    text-align: center;
    margin-top: 16px;
  }
  .total-label { font-size: 13px; color: var(--accent); font-weight: 500; margin-bottom: 8px; letter-spacing: 1px; }
  .total-amount {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 48px;
    letter-spacing: 2px;
    color: var(--accent);
    line-height: 1;
    margin-bottom: 4px;
  }
  .total-note { font-size: 11px; color: var(--text2); }

  .overtime-note {
    background: rgba(88,166,255,0.1);
    border: 1px solid rgba(88,166,255,0.3);
    border-radius: 8px;
    padding: 10px 14px;
    font-size: 12px;
    color: var(--blue);
    margin-bottom: 12px;
  }

  /* Responsive */
  @media (max-width: 600px) {
    .cal-day { min-height: 60px; padding: 4px; }
    .day-num { font-size: 11px; width: 22px; height: 22px; }
    .day-badge { font-size: 8px; padding: 1px 4px; }
    .summary-strip { gap: 8px; }
    .summary-card .s-num { font-size: 22px; }
    .total-amount { font-size: 36px; }
  }
</style>
</head>
<body>

<div class="header">
  <div>
    <div style="display:flex; align-items:center; gap:12px;">
      <img src="data:image/jpeg;base64,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" style="height:44px; width:44px; object-fit:contain; border-radius:8px; background:#fff; padding:3px;">
      <div>
        <div style="font-size:15px; font-weight:700; color:var(--text); letter-spacing:1px; line-height:1.2;">SD BIOSENSOR</div>
        <div class="header-sub">ì¶œê·¼ë¶€ ê´€ë¦¬ ì‹œìŠ¤í…œ</div>
      </div>
    </div>
  </div>
  <button class="nav-btn" id="toggleBtn" onclick="togglePage()">ğŸ’° ê¸‰ì—¬ê³„ì‚°ê¸°</button>
</div>

<!-- CALENDAR PAGE -->
<div class="page active" id="calPage">
  <div class="calendar-container">
    <div class="summary-strip" id="summaryStrip"></div>
    <div class="month-nav">
      <button onclick="changeMonth(-1)">â€¹</button>
      <div class="month-title" id="monthTitle"></div>
      <button onclick="changeMonth(1)">â€º</button>
    </div>
    <div class="calendar">
      <div class="cal-header">
        <div>ì¼</div><div>ì›”</div><div>í™”</div><div>ìˆ˜</div><div>ëª©</div><div>ê¸ˆ</div><div>í† </div>
      </div>
      <div class="cal-grid" id="calGrid"></div>
    </div>
  </div>
</div>

<!-- PAYROLL PAGE -->
<div class="page" id="payPage">
  <div class="payroll-container">
    <div class="payroll-title">PAYROLL</div>
    <div class="payroll-sub">ê¸‰ì—¬ê³„ì‚°ê¸° â€” ì„¸ê¸ˆ ì œì™¸ ì‹¤ìˆ˜ë ¹ì•¡ ê¸°ì¤€</div>

    <div class="pay-section">
      <div class="pay-section-title">ğŸ“Š ê¸°ë³¸ ì •ë³´ <span style="font-size:10px;color:var(--accent);font-weight:400;letter-spacing:0;">âœï¸ ì§ì ‘ ìˆ˜ì • ê°€ëŠ¥</span></div>
      <div class="pay-input-row">
        <span class="pay-input-label">í†µìƒì‹œê¸‰</span>
        <div class="pay-input-controls">
          <input type="number" class="pay-number-input" id="inputHourly" value="11516" min="0" step="1" oninput="updateBaseInfo()" style="width:110px;">
          <span class="pay-unit">ì›</span>
        </div>
      </div>
      <div class="pay-input-row">
        <span class="pay-input-label">ê¸°ë³¸ê¸‰</span>
        <div class="pay-input-controls">
          <input type="number" class="pay-number-input" id="inputBasePay" value="2156880" min="0" step="1000" oninput="updateBaseInfo()" style="width:110px;">
          <span class="pay-unit">ì›</span>
        </div>
      </div>
      <div class="pay-row">
        <span class="pay-row-label">ê¸°ë³¸ ê·¼ë¬´ ì‹œê°„/ì¼</span>
        <span class="pay-row-value">8ì‹œê°„</span>
      </div>
    </div>

    <div class="pay-section">
      <div class="pay-section-title">â• ì¶”ê°€ ìˆ˜ë‹¹</div>
      <div class="pay-input-row">
        <span class="pay-input-label">ìì¬ìˆ˜ë‹¹</span>
        <div class="pay-input-controls">
          <button class="pay-toggle" id="toggle_jajae" onclick="toggleAllowance('jajae')">OFF</button>
          <span class="pay-row-value" id="val_jajae" style="color:var(--text2)">+0ì›</span>
        </div>
      </div>
      <div class="pay-input-row">
        <span class="pay-input-label">ì§€ê²Œì°¨ìˆ˜ë‹¹</span>
        <div class="pay-input-controls">
          <button class="pay-toggle" id="toggle_jigeji" onclick="toggleAllowance('jigeji')">OFF</button>
          <span class="pay-row-value" id="val_jigeji" style="color:var(--text2)">+0ì›</span>
        </div>
      </div>
    </div>

    <div class="pay-section">
      <div class="pay-section-title">â° ì—°ì¥ê·¼ë¡œ ìˆ˜ë‹¹</div>
      <div class="overtime-note">ì—°ì¥ìˆ˜ë‹¹ = ì‹œê¸‰ Ã— 1.5 Ã— ì—°ì¥ì‹œê°„ìˆ˜</div>
      <div class="pay-input-row">
        <span class="pay-input-label">í‰ì¼ ì—°ì¥ê·¼ë¡œ ì‹œê°„</span>
        <div class="pay-input-controls">
          <input type="number" class="pay-number-input" id="overtimeHours" value="0" min="0" max="100" step="0.5" oninput="calcPayroll()">
          <span class="pay-unit">ì‹œê°„</span>
        </div>
      </div>
      <div class="pay-input-row">
        <span class="pay-input-label">í† ìš” íŠ¹ê·¼ ì‹œê°„</span>
        <div class="pay-input-controls">
          <input type="number" class="pay-number-input" id="saturdayHours" value="0" min="0" max="100" step="0.5" oninput="calcPayroll()">
          <span class="pay-unit">ì‹œê°„</span>
        </div>
      </div>
      <div class="pay-row">
        <span class="pay-row-label">ì—°ì¥ìˆ˜ë‹¹ í•©ê³„</span>
        <span class="pay-row-value add" id="overtimePay">+0ì›</span>
      </div>
    </div>

    <div class="pay-section">
      <div class="pay-section-title">ğŸ“… ê·¼íƒœ ê³µì œ (ì´ë²ˆë‹¬ ê¸°ì¤€)</div>
      <div id="payAttendanceInfo" class="overtime-note">ë‹¬ë ¥ì— ì…ë ¥ëœ ë°ì´í„°ë¥¼ ìë™ ë°˜ì˜í•©ë‹ˆë‹¤.</div>
      <div class="pay-input-row">
        <span class="pay-input-label">ì—°ì°¨ ì¼ìˆ˜</span>
        <div class="pay-input-controls">
          <input type="number" class="pay-number-input" id="annualLeave" value="0" min="0" max="30" oninput="calcPayroll()">
          <span class="pay-unit">ì¼</span>
          <span class="pay-row-value" id="annualDeduct" style="color:var(--text2)">0ì›</span>
        </div>
      </div>
      <div class="pay-input-row">
        <span class="pay-input-label">ë°˜ì°¨ ì¼ìˆ˜</span>
        <div class="pay-input-controls">
          <input type="number" class="pay-number-input" id="halfLeave" value="0" min="0" max="30" oninput="calcPayroll()">
          <span class="pay-unit">ì¼</span>
          <span class="pay-row-value deduct" id="halfDeduct">-0ì›</span>
        </div>
      </div>
      <div class="pay-input-row">
        <span class="pay-input-label">ê²°ê·¼ ì¼ìˆ˜</span>
        <div class="pay-input-controls">
          <input type="number" class="pay-number-input" id="absentDays" value="0" min="0" max="30" oninput="calcPayroll()">
          <span class="pay-unit">ì¼</span>
          <span class="pay-row-value deduct" id="absentDeduct">-0ì›</span>
        </div>
      </div>
      <div class="pay-input-row">
        <span class="pay-input-label">ì¡°í‡´/ì§€ê° ì‹œê°„</span>
        <div class="pay-input-controls">
          <input type="number" class="pay-number-input" id="earlyHours" value="0" min="0" max="50" step="0.5" oninput="calcPayroll()">
          <span class="pay-unit">ì‹œê°„</span>
          <span class="pay-row-value deduct" id="earlyDeduct">-0ì›</span>
        </div>
      </div>
    </div>

    <div class="pay-section">
      <div class="pay-section-title">ğŸ“‹ ê¸‰ì—¬ ë‚´ì—­ ìš”ì•½</div>
      <div class="pay-row">
        <span class="pay-row-label">ê¸°ë³¸ê¸‰</span>
        <span class="pay-row-value">2,156,880ì›</span>
      </div>
      <div class="pay-row">
        <span class="pay-row-label">ìì¬ìˆ˜ë‹¹</span>
        <span class="pay-row-value add" id="sum_jajae">+0ì›</span>
      </div>
      <div class="pay-row">
        <span class="pay-row-label">ì§€ê²Œì°¨ìˆ˜ë‹¹</span>
        <span class="pay-row-value add" id="sum_jigeji">+0ì›</span>
      </div>
      <div class="pay-row">
        <span class="pay-row-label">ì—°ì¥ìˆ˜ë‹¹</span>
        <span class="pay-row-value add" id="sum_overtime">+0ì›</span>
      </div>
      <div class="pay-row">
        <span class="pay-row-label">ê·¼íƒœ ê³µì œ í•©ê³„</span>
        <span class="pay-row-value deduct" id="sum_deduct">-0ì›</span>
      </div>
    </div>

    <div class="total-box">
      <div class="total-label">ì˜ˆìƒ ì‹¤ìˆ˜ë ¹ì•¡ (ì„¸ì „)</div>
      <div class="total-amount" id="totalAmount">2,156,880</div>
      <div class="total-note">ì› Â· ì„¸ê¸ˆ(4ëŒ€ë³´í—˜, ì†Œë“ì„¸) ë³„ë„</div>
    </div>
  </div>
</div>

<!-- MODAL -->
<div class="modal-overlay" id="modalOverlay">
  <div class="modal">
    <div class="modal-title">ğŸ“… <span id="modalDateTitle"></span></div>
    <div class="modal-date" id="modalDateSub"></div>

    <div class="status-grid">
      <button class="status-btn" data-v="ì¶œê·¼" onclick="selectStatus('ì¶œê·¼')">âœ… ì¶œê·¼</button>
      <button class="status-btn" data-v="ì—°ì°¨" onclick="selectStatus('ì—°ì°¨')">ğŸŒ´ ì—°ì°¨</button>
      <button class="status-btn" data-v="ë°˜ì°¨" onclick="selectStatus('ë°˜ì°¨')">ğŸŒ“ ë°˜ì°¨</button>
      <button class="status-btn" data-v="ì¡°í‡´" onclick="selectStatus('ì¡°í‡´')">ğŸš¶ ì¡°í‡´</button>
      <button class="status-btn" data-v="ê²°ê·¼" onclick="selectStatus('ê²°ê·¼')">âŒ ê²°ê·¼</button>
      <button class="status-btn" data-v="íœ´ì¼" onclick="selectStatus('íœ´ì¼')">ğŸ˜´ íœ´ì¼</button>
      <button class="status-btn" data-v="ê³µíœ´ì¼" onclick="selectStatus('ê³µíœ´ì¼')">ğŸŒ ê³µíœ´ì¼</button>
    </div>

    <div id="timeFields">
      <div class="time-section">
        <div class="time-label">ğŸ• ì¶œê·¼ ì‹œê°„</div>
        <select class="time-select" id="startTimeSelect"></select>
      </div>
      <div class="time-section">
        <div class="time-label">ğŸ•• í‡´ê·¼ ì‹œê°„</div>
        <select class="time-select" id="endTimeSelect" onchange="updateOvertimeInfo()"></select>
      </div>
      <div class="overtime-info" id="overtimeInfo"></div>
    </div>

    <div class="modal-actions">
      <button class="btn-save" onclick="saveDay()">ì €ì¥</button>
      <button class="btn-delete" onclick="deleteDay()">ì‚­ì œ</button>
      <button class="btn-cancel" onclick="closeModal()">ì·¨ì†Œ</button>
    </div>
  </div>
</div>

<script>
// â”€â”€â”€ STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const HOURLY = 11516.17;
const BASE_PAY = 2156880;

function getHourly() {
  return parseFloat(document.getElementById('inputHourly')?.value) || HOURLY;
}
function getBasePay() {
  return parseFloat(document.getElementById('inputBasePay')?.value) || BASE_PAY;
}
function updateBaseInfo() {
  calcPayroll();
}
const ALLOWANCES = { jajae: 200000, jigeji: 600000 };
let allowanceOn = { jajae: false, jigeji: false };

let currentYear = new Date().getFullYear();
let currentMonth = new Date().getMonth();
let attendance = JSON.parse(localStorage.getItem('attendance') || '{}');
let selectedDate = null;
let selectedStatus = '';

// â”€â”€â”€ PAGE TOGGLE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function togglePage() {
  const cal = document.getElementById('calPage');
  const pay = document.getElementById('payPage');
  const btn = document.getElementById('toggleBtn');
  if (cal.classList.contains('active')) {
    cal.classList.remove('active');
    pay.classList.add('active');
    btn.textContent = 'ğŸ“… ì¶œê·¼ë¶€';
    syncAttendanceToPayroll();
  } else {
    pay.classList.remove('active');
    cal.classList.add('active');
    btn.textContent = 'ğŸ’° ê¸‰ì—¬ê³„ì‚°ê¸°';
  }
}

// â”€â”€â”€ CALENDAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function changeMonth(dir) {
  currentMonth += dir;
  if (currentMonth > 11) { currentMonth = 0; currentYear++; }
  if (currentMonth < 0) { currentMonth = 11; currentYear--; }
  renderCalendar();
}

const MONTHS = ['1ì›”','2ì›”','3ì›”','4ì›”','5ì›”','6ì›”','7ì›”','8ì›”','9ì›”','10ì›”','11ì›”','12ì›”'];
const DAYS_KO = ['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '];

function renderCalendar() {
  document.getElementById('monthTitle').textContent = `${currentYear}ë…„ ${MONTHS[currentMonth]}`;
  const grid = document.getElementById('calGrid');
  grid.innerHTML = '';

  const today = new Date();
  const firstDay = new Date(currentYear, currentMonth, 1).getDay();
  const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();

  // empty cells
  for (let i = 0; i < firstDay; i++) {
    const el = document.createElement('div');
    el.className = 'cal-day empty';
    grid.appendChild(el);
  }

  for (let d = 1; d <= daysInMonth; d++) {
    const key = `${currentYear}-${String(currentMonth+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
    const rec = attendance[key];
    const el = document.createElement('div');
    el.className = 'cal-day';
    if (d === today.getDate() && currentMonth === today.getMonth() && currentYear === today.getFullYear()) {
      el.classList.add('today');
    }

    let inner = `<div class="day-num">${d}</div>`;
    if (rec) {
      if (rec.status && rec.status !== 'íœ´ì¼') {
        inner += `<div class="day-badge badge-${rec.status}">${rec.status}</div>`;
      }
      if (rec.status === 'ì¶œê·¼' || rec.status === 'ì¡°í‡´') {
        inner += `<div class="day-time">${rec.start || ''} â†’ ${rec.end || ''}</div>`;
        if (rec.overtimeHours > 0) {
          inner += `<div class="day-overtime">+${rec.overtimeHours.toFixed(1)}h OT</div>`;
        }
        if (rec.saturdayHours > 0) {
          inner += `<div class="day-overtime">â­${rec.saturdayHours.toFixed(1)}h íŠ¹ê·¼</div>`;
        }
      }
    }
    el.innerHTML = inner;
    el.addEventListener('click', () => openModal(key, d));
    grid.appendChild(el);
  }

  renderSummary();
}

function renderSummary() {
  const prefix = `${currentYear}-${String(currentMonth+1).padStart(2,'0')}-`;
  let counts = { ì¶œê·¼:0, ì—°ì°¨:0, ë°˜ì°¨:0, ì¡°í‡´:0, ê²°ê·¼:0, overtime:0, ê³µíœ´ì¼:0 };
  for (const [k,v] of Object.entries(attendance)) {
    if (!k.startsWith(prefix)) continue;
    if (v.status === 'ì¶œê·¼') counts.ì¶œê·¼++;
    else if (v.status === 'ì—°ì°¨') counts.ì—°ì°¨++;
    else if (v.status === 'ë°˜ì°¨') counts.ë°˜ì°¨++;
    else if (v.status === 'ì¡°í‡´') counts.ì¡°í‡´++;
    else if (v.status === 'ê²°ê·¼') counts.ê²°ê·¼++;
    else if (v.status === 'ê³µíœ´ì¼') counts.ê³µíœ´ì¼++;
    if (v.overtimeHours) counts.overtime += v.overtimeHours;
  }

  const colors = { ì¶œê·¼: 'var(--green)', ì—°ì°¨: 'var(--purple)', ë°˜ì°¨: 'var(--blue)', ì¡°í‡´: 'var(--yellow)', ê²°ê·¼: 'var(--red)', ê³µíœ´ì¼: '#ff9999' };
  let html = '';
  for (const [k,c] of Object.entries(colors)) {
    html += `<div class="summary-card">
      <div class="s-num" style="color:${c}">${counts[k]}</div>
      <div class="s-label">${k}</div>
    </div>`;
  }
  html += `<div class="summary-card">
    <div class="s-num" style="color:var(--accent)">${counts.overtime.toFixed(1)}</div>
    <div class="s-label">ì—°ì¥h</div>
  </div>`;
  document.getElementById('summaryStrip').innerHTML = html;
}

// â”€â”€â”€ MODAL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function openModal(key, d) {
  selectedDate = key;
  const parts = key.split('-');
  const dow = new Date(+parts[0], +parts[1]-1, +parts[2]).getDay();
  document.getElementById('modalDateTitle').textContent = `${MONTHS[+parts[1]-1]} ${d}ì¼ (${DAYS_KO[dow]})`;
  document.getElementById('modalDateSub').textContent = key;

  const rec = attendance[key] || {};
  selectedStatus = rec.status || '';
  document.querySelectorAll('.status-btn').forEach(b => {
    b.classList.toggle('selected', b.dataset.v === selectedStatus);
  });

  buildStartTimes();
  buildEndTimes();

  // ì €ì¥ëœ ê°’ ìˆìœ¼ë©´ ë³µì›, ì—†ìœ¼ë©´ ê¸°ë³¸ê°’
  document.getElementById('startTimeSelect').value = rec.start || '09:00';
  document.getElementById('endTimeSelect').value = rec.end || '18:00';

  updateTimeFieldsVisibility();
  updateOvertimeInfo();

  document.getElementById('modalOverlay').classList.add('open');
}

function closeModal() {
  document.getElementById('modalOverlay').classList.remove('open');
}

function selectStatus(v) {
  selectedStatus = v;
  document.querySelectorAll('.status-btn').forEach(b => {
    b.classList.toggle('selected', b.dataset.v === v);
  });
  updateTimeFieldsVisibility();
  updateOvertimeInfo();
}

function updateTimeFieldsVisibility() {
  const show = ['ì¶œê·¼','ì¡°í‡´'].includes(selectedStatus);
  document.getElementById('timeFields').style.display = show ? 'block' : 'none';
}

function buildStartTimes() {
  const sel = document.getElementById('startTimeSelect');
  sel.innerHTML = '';
  for (let h = 8; h <= 15; h++) {
    for (let m = 0; m < 60; m += 10) {
      if (h === 15 && m > 0) break;
      const val = `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}`;
      const opt = document.createElement('option');
      opt.value = val; opt.textContent = val;
      sel.appendChild(opt);
    }
  }
  sel.value = '09:00';
}

function buildEndTimes() {
  const sel = document.getElementById('endTimeSelect');
  sel.innerHTML = '';
  for (let h = 0; h < 24; h++) {
    for (let m = 0; m < 60; m += 10) {
      const val = `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}`;
      const opt = document.createElement('option');
      opt.value = val; opt.textContent = val;
      sel.appendChild(opt);
    }
  }
  sel.value = '18:00';
}

function updateOvertimeInfo() {
  const end = document.getElementById('endTimeSelect').value;
  const info = document.getElementById('overtimeInfo');

  // OT ê³„ì‚°ì€ í•­ìƒ 09:00 ê¸°ì¤€
  let [eh,em] = end.split(':').map(Number);
  const endTotalMin = eh * 60 + em;
  const startFixed = 9 * 60; // 09:00 ê³ ì •
  const totalMin = endTotalMin - startFixed;
  let breakMin = 0;
  if (endTotalMin > 13 * 60) breakMin += 60; // ì ì‹¬ 1ì‹œê°„
  if (endTotalMin > 18 * 60 + 30) breakMin += 30; // ì €ë… 30ë¶„
  const workHours = Math.max(0, (totalMin - breakMin) / 60);
  const baseHours = 8;
  const overtime = Math.max(0, workHours - baseHours);

  if (overtime > 0) {
    const pay = Math.round(getHourly() * 1.5 * overtime);
    info.innerHTML = `â° ì—°ì¥ê·¼ë¡œ: <strong>${overtime.toFixed(1)}ì‹œê°„</strong> â€” ì˜ˆìƒ ì—°ì¥ìˆ˜ë‹¹: <strong>+${pay.toLocaleString()}ì›</strong>`;
    info.style.backgroundColor = 'rgba(240,165,0,0.1)';
    info.style.borderColor = 'rgba(240,165,0,0.3)';
    info.style.color = 'var(--accent)';
    info.style.display = 'block';
  } else if (workHours < baseHours && workHours > 0 && selectedStatus === 'ì¡°í‡´') {
    const shortHours = baseHours - workHours;
    const deduct = Math.round(getHourly() * shortHours);
    info.innerHTML = `ğŸš¶ ì¡°í‡´ ê³µì œ: <strong>${shortHours.toFixed(1)}ì‹œê°„</strong> â€” ì˜ˆìƒ ê³µì œ: <strong>-${deduct.toLocaleString()}ì›</strong>`;
    info.style.backgroundColor = 'rgba(248,81,73,0.1)';
    info.style.borderColor = 'rgba(248,81,73,0.3)';
    info.style.color = 'var(--red)';
    info.style.display = 'block';
  } else {
    info.style.display = 'none';
  }
}

function calcOvertimeFromTimes(start, end) {
  if (!end) return 0;
  // OT ê³„ì‚°ì€ í•­ìƒ 09:00 ê¸°ì¤€
  let [eh,em] = end.split(':').map(Number);
  const endTotalMin = eh * 60 + em;
  const totalMin = endTotalMin - 9 * 60;
  let breakMin = 0;
  if (endTotalMin > 13 * 60) breakMin += 60;
  if (endTotalMin > 18 * 60 + 30) breakMin += 30;
  const workHours = Math.max(0, (totalMin - breakMin) / 60);
  return Math.max(0, workHours - 8);
}

function calcShortHoursFromTimes(start, end) {
  if (!end) return 0;
  // ì¡°í‡´ ê³µì œë„ 09:00 ê¸°ì¤€
  let [eh,em] = end.split(':').map(Number);
  const endTotalMin = eh * 60 + em;
  const totalMin = endTotalMin - 9 * 60;
  let breakMin = 0;
  if (endTotalMin > 13 * 60) breakMin += 60;
  if (endTotalMin > 18 * 60 + 30) breakMin += 30;
  const workHours = Math.max(0, (totalMin - breakMin) / 60);
  return Math.max(0, 8 - workHours);
}

function saveDay() {
  if (!selectedDate) return;
  const start = document.getElementById('startTimeSelect').value;
  const end = document.getElementById('endTimeSelect').value;
  const overtimeHours = calcOvertimeFromTimes(start, end);
  const shortHours = selectedStatus === 'ì¡°í‡´' ? calcShortHoursFromTimes(start, end) : 0;

  // í† ìš”ì¼ ì—¬ë¶€ í™•ì¸
  const parts = selectedDate.split('-');
  const dow = new Date(+parts[0], +parts[1]-1, +parts[2]).getDay();
  const isSaturday = dow === 6;

  // í† ìš”ì¼ íŠ¹ê·¼ ì‹œê°„: 09:00 ê¸°ì¤€ ì‹¤ê·¼ë¬´ì‹œê°„ ì „ì²´ (OT ì•„ë‹˜)
  let saturdayHours = 0;
  if (isSaturday && selectedStatus === 'ì¶œê·¼') {
    const [eh, em] = end.split(':').map(Number);
    const endTotal = eh * 60 + em;
    const totalMin = endTotal - 9 * 60;
    let breakMin = 0;
    if (endTotal > 13 * 60) breakMin += 60;
    if (endTotal > 18 * 60 + 30) breakMin += 30;
    saturdayHours = Math.max(0, (totalMin - breakMin) / 60);
  }

  attendance[selectedDate] = {
    status: selectedStatus,
    start: ['ì¶œê·¼','ì¡°í‡´'].includes(selectedStatus) ? start : null,
    end: ['ì¶œê·¼','ì¡°í‡´'].includes(selectedStatus) ? end : null,
    overtimeHours: (selectedStatus === 'ì¶œê·¼' && !isSaturday) ? overtimeHours : 0,
    saturdayHours: saturdayHours,
    shortHours: shortHours
  };

  localStorage.setItem('attendance', JSON.stringify(attendance));
  closeModal();
  renderCalendar();
}

function deleteDay() {
  if (!selectedDate) return;
  delete attendance[selectedDate];
  localStorage.setItem('attendance', JSON.stringify(attendance));
  closeModal();
  renderCalendar();
}

// â”€â”€â”€ PAYROLL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function toggleAllowance(key) {
  allowanceOn[key] = !allowanceOn[key];
  const btn = document.getElementById(`toggle_${key}`);
  const val = document.getElementById(`val_${key}`);
  const sum = document.getElementById(`sum_${key}`);
  if (allowanceOn[key]) {
    btn.textContent = 'ON';
    btn.classList.add('on');
    val.style.color = 'var(--green)';
    val.textContent = `+${ALLOWANCES[key].toLocaleString()}ì›`;
    sum.textContent = `+${ALLOWANCES[key].toLocaleString()}ì›`;
    sum.style.color = 'var(--green)';
  } else {
    btn.textContent = 'OFF';
    btn.classList.remove('on');
    val.style.color = 'var(--text2)';
    val.textContent = '+0ì›';
    sum.textContent = '+0ì›';
  }
  calcPayroll();
}

function syncAttendanceToPayroll() {
  const prefix = `${currentYear}-${String(currentMonth+1).padStart(2,'0')}-`;
  let annualDays = 0, halfDays = 0, absentDays = 0, earlyHours = 0, overtimeH = 0, saturdayH = 0;

  for (const [k,v] of Object.entries(attendance)) {
    if (!k.startsWith(prefix)) continue;
    if (v.status === 'ì—°ì°¨') annualDays++;
    else if (v.status === 'ë°˜ì°¨') halfDays++;
    else if (v.status === 'ê²°ê·¼') absentDays++;
    else if (v.status === 'ì¡°í‡´') earlyHours += (v.shortHours || 0);
    if (v.overtimeHours) overtimeH += v.overtimeHours;
    if (v.saturdayHours) saturdayH += v.saturdayHours;
  }

  document.getElementById('annualLeave').value = annualDays;
  document.getElementById('halfLeave').value = halfDays;
  document.getElementById('absentDays').value = absentDays;
  document.getElementById('earlyHours').value = earlyHours.toFixed(1);
  document.getElementById('overtimeHours').value = overtimeH.toFixed(1);
  document.getElementById('saturdayHours').value = saturdayH.toFixed(1);

  const infoEl = document.getElementById('payAttendanceInfo');
  infoEl.textContent = `ğŸ“… ${currentYear}ë…„ ${MONTHS[currentMonth]} ë‹¬ë ¥ ë°ì´í„° ìë™ ë°˜ì˜ë¨ (ì—°ì°¨Â·ê³µíœ´ì¼ì€ ìœ ê¸‰ â€” ê³µì œ ì—†ìŒ)`;

  calcPayroll();
}

function calcPayroll() {
  const HOURLY_NOW = getHourly();
  const BASE_NOW = getBasePay();

  const overtimeH = parseFloat(document.getElementById('overtimeHours').value) || 0;
  const saturdayH = parseFloat(document.getElementById('saturdayHours').value) || 0;
  const annual = parseFloat(document.getElementById('annualLeave').value) || 0;
  const half = parseFloat(document.getElementById('halfLeave').value) || 0;
  const absent = parseFloat(document.getElementById('absentDays').value) || 0;
  const earlyH = parseFloat(document.getElementById('earlyHours').value) || 0;

  const overtimePay = Math.round(HOURLY_NOW * 1.5 * overtimeH);
  const saturdayPay = Math.round(HOURLY_NOW * 1.5 * saturdayH); // í† ìš” íŠ¹ê·¼ 1.5ë°°
  const annualDeduct = 0;
  const halfDeduct = Math.round(HOURLY_NOW * 4 * half);
  const absentDeduct = Math.round(HOURLY_NOW * 8 * absent);
  const earlyDeduct = Math.round(HOURLY_NOW * earlyH);
  const totalDeduct = halfDeduct + absentDeduct + earlyDeduct;

  const jajae = allowanceOn.jajae ? ALLOWANCES.jajae : 0;
  const jigeji = allowanceOn.jigeji ? ALLOWANCES.jigeji : 0;

  const total = BASE_NOW + jajae + jigeji + overtimePay + saturdayPay - totalDeduct;

  document.getElementById('overtimePay').textContent = `+${(overtimePay + saturdayPay).toLocaleString()}ì›`;
  document.getElementById('annualDeduct').textContent = `0ì›`;
  document.getElementById('annualDeduct').style.color = 'var(--text2)';
  document.getElementById('halfDeduct').textContent = `-${halfDeduct.toLocaleString()}ì›`;
  document.getElementById('absentDeduct').textContent = `-${absentDeduct.toLocaleString()}ì›`;
  document.getElementById('earlyDeduct').textContent = `-${earlyDeduct.toLocaleString()}ì›`;
  document.getElementById('sum_overtime').textContent = `+${(overtimePay + saturdayPay).toLocaleString()}ì›`;
  document.getElementById('sum_deduct').textContent = `-${totalDeduct.toLocaleString()}ì›`;
  document.getElementById('totalAmount').textContent = Math.max(0, total).toLocaleString();

  const basePay = document.querySelector('#payPage .pay-section:last-of-type .pay-row:first-child .pay-row-value');
  if (basePay) basePay.textContent = BASE_NOW.toLocaleString() + 'ì›';
}

// â”€â”€â”€ INIT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
renderCalendar();
calcPayroll();

document.getElementById('modalOverlay').addEventListener('click', function(e) {
  if (e.target === this) closeModal();
});
</script>
</body>
</html>
